<!doctype html>
<html lang="zh-CN">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
<title>è¿˜æœ‰å¤šä¹…æˆ‘æ‰èƒ½åœ¨ä½ èº«è¾¹</title>
<style>
  :root{
    --text:#fff; --muted:rgba(255,255,255,.88);
    --panel:rgba(0,0,0,.28);
    --glass:rgba(0,0,0,.10);     /* æ¸…æ™°ç‰ˆï¼šæ›´é€šé€ */
    --shadow:0 12px 28px rgba(0,0,0,.45);
    --radius:16px;
    --dim:.08;                   /* æ¸…æ™°ç‰ˆé®ç½©å¼ºåº¦ */
    --bg-composite:none;         /* JS å†™å…¥ï¼šé®ç½© + èƒŒæ™¯å›¾ */

    --fz-base: clamp(14px,1.6vw,18px);
    --fz-h1:   clamp(22px,2.4vw,34px);
    --fz-num:  clamp(36px,6vw,72px);
  }

  html,body{
    margin:0; padding:0; height:100%;
    color:var(--text); background:#0b0f16;
    -webkit-font-smoothing:antialiased;
    font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Arial,"Noto Sans SC","PingFang SC","Hiragino Sans GB","Microsoft YaHei",sans-serif;
    font-size:var(--fz-base);
  }
  @supports (height:100dvh){ body{ min-height:100dvh; } }

  /* èƒŒæ™¯ï¼šå’Œâ€œå¹´é¾„é¡µâ€ä¸€è‡´â€”â€”ç”± CSS å˜é‡é©±åŠ¨ */
  body::before{
    content:""; position:fixed; inset:0; z-index:-2;
    background-image: var(--bg-composite);
    background-size:cover; background-position:center 35%;
    filter:saturate(112%) contrast(106%) brightness(0.92);
  }
  /* æŸ”å’Œå…‰æ™•ï¼ˆè£…é¥°ï¼‰ */
  body::after{
    content:""; position:fixed; inset:-25vh -25vw; z-index:-1; filter:blur(70px) opacity(.75);
    background:
      radial-gradient(40% 40% at 20% 20%, rgba(255,154,162,.20), transparent 60%),
      radial-gradient(45% 45% at 85% 25%, rgba(156,217,255,.20), transparent 60%),
      radial-gradient(50% 50% at 18% 80%, rgba(168,230,207,.18), transparent 60%),
      radial-gradient(55% 55% at 75% 85%, rgba(199,206,255,.18), transparent 60%);
  }

  .wrap{max-width:1120px;margin:0 auto;padding:28px 22px 72px}
  h1{margin:0 0 10px;font-size:var(--fz-h1);letter-spacing:.3px;text-shadow:0 2px 10px rgba(0,0,0,.35)}
  .sub{color:var(--muted);font-size:.95em;margin:6px 0 10px;text-shadow:0 2px 8px rgba(0,0,0,.30)}
  .sub:empty{min-height:1em}

  /* æœ€å¤§å•ä½ä¸ºå¤©ï¼šå¤©/å°æ—¶/åˆ†é’Ÿ/ç§’ */
  .panel{display:grid;grid-template-columns:repeat(auto-fit, minmax(150px, 1fr));gap:14px}
  .card{
    position:relative; background:var(--glass); backdrop-filter:blur(1.5px);
    border-radius:var(--radius); padding:18px; text-align:center; box-shadow:var(--shadow); overflow:hidden
  }
  .pill::before, .card::before, .fab::before{
    content:""; position:absolute; inset:0; border-radius:inherit; padding:1.2px;
    background:conic-gradient(from 180deg,#ff9aa2,#ffdac1,#e2f0cb,#a8e6cf,#9cd9ff,#c7ceff,#ff9aa2);
    -webkit-mask:linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
    -webkit-mask-composite:xor; mask-composite:exclude; pointer-events:none; opacity:.75;
  }
  .num{font-variant-numeric:tabular-nums;letter-spacing:.5px;font-size:var(--fz-num);font-weight:900;margin-bottom:6px;text-shadow:0 1px 6px rgba(0,0,0,.25)}
  .label{font-size:.95em;opacity:.95}
  .summary{margin-top:14px;font-variant-numeric:tabular-nums;text-shadow:0 2px 8px rgba(0,0,0,.28)}

  /* å³ä¸‹è§’ï¼šå¯¼å…¥/æ¸…é™¤èƒŒæ™¯ */
  .fab-wrap{position:fixed; right:14px; bottom:14px; display:flex; flex-direction:column; gap:10px; z-index:5}
  .fab{position:relative; width:40px; height:40px; border-radius:50%;
    background:rgba(0,0,0,.28); backdrop-filter:blur(6px); box-shadow:var(--shadow);
    display:flex; align-items:center; justify-content:center; font-size:18px; opacity:.85; overflow:hidden}
  .fab span{filter:drop-shadow(0 2px 6px rgba(0,0,0,.45))}
  #file{display:none}
</style>
</head>
<body>
  <div class="wrap">
    <h1>è¿˜æœ‰å¤šä¹…æˆ‘æ‰èƒ½åœ¨ä½ èº«è¾¹</h1>
    <div class="sub" id="nowline"></div>

    <div class="panel" id="panel"></div>

    <div class="summary" id="summary"></div>
    <div class="sub" id="targetline"></div>
  </div>

  <!-- å³ä¸‹è§’èƒŒæ™¯æŒ‰é’® -->
  <div class="fab-wrap">
    <div class="fab" id="btnImport" title="å¯¼å…¥èƒŒæ™¯"><span>ğŸ–¼ï¸</span></div>
    <div class="fab" id="btnClear"  title="æ¸…é™¤èƒŒæ™¯"><span>âŒ«</span></div>
  </div>
  <input id="file" type="file" accept="image/*">

<script>
/* ===== ä¸â€œå¹´é¾„é¡µâ€å®Œå…¨ä¸€è‡´çš„èƒŒæ™¯ç®¡çº¿ ===== */
const LS_BG = 'age_bg_dataurl';   // â† ç”¨åŒä¸€ä¸ª keyï¼Œè®©ä¸¤é¡µå…±äº«åŒä¸€å¼ èƒŒæ™¯

function applyBG(dataUrl){
  const dim = getComputedStyle(document.documentElement).getPropertyValue('--dim').trim() || '.08';
  const overlay = `linear-gradient(rgba(0,0,0,${dim}), rgba(0,0,0,${dim}))`;
  const composite = dataUrl ? `${overlay}, url(${dataUrl})` : `${overlay}, none`;
  document.documentElement.style.setProperty('--bg-composite', composite);
}
// åˆå§‹åŒ–ï¼šè¯»å·²æœ‰èƒŒæ™¯ï¼ˆè‹¥ä½ åœ¨â€œå¹´é¾„é¡µâ€è®¾è¿‡ï¼Œè¿™é‡Œä¼šç›´æ¥æ˜¾ç¤ºï¼‰
try{ applyBG(localStorage.getItem(LS_BG)); }catch(e){}

// å¯¼å…¥å¹¶å‹ç¼©ï¼ˆæœ€é•¿è¾¹ 1600ï¼Œjpeg 0.85ï¼‰
const file=document.getElementById('file');
document.getElementById('btnImport').addEventListener('click',()=>file.click());
file.addEventListener('change', ()=>{
  const f=file.files && file.files[0]; if(!f) return;
  const img=new Image(); const reader=new FileReader();
  reader.onload=()=>{ img.onload=()=>{
      const max=1600; let w=img.naturalWidth, h=img.naturalHeight;
      const r=Math.min(1, max/w, max/h); w=Math.round(w*r); h=Math.round(h*r);
      const c=document.createElement('canvas'); c.width=w; c.height=h;
      c.getContext('2d').drawImage(img,0,0,w,h);
      const dataUrl=c.toDataURL('image/jpeg',0.85);
      applyBG(dataUrl);                    // ç«‹åˆ»æ˜¾ç¤º
      try{ localStorage.setItem(LS_BG, dataUrl); }catch(e){}
      file.value="";
    }; img.src=reader.result;
  }; reader.readAsDataURL(f);
});
document.getElementById('btnClear').addEventListener('click', ()=>{
  applyBG(null); try{ localStorage.removeItem(LS_BG); }catch(e){}
});

/* ===== å€’è®¡æ—¶ï¼ˆæœ€å¤§å•ä½ï¼šå¤©ï¼‰ ===== */
const TZ = 'Asia/Shanghai';
const TARGET_ISO = '2025-12-21T09:00:00+08:00'; // åŒ—äº¬æ—¶é—´
const TARGET = new Date(TARGET_ISO).getTime();

function pad(n){return String(n).padStart(2,'0')}
function nowInZoneParts(zone){
  const fmt=new Intl.DateTimeFormat('en-CA',{timeZone:zone,year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:false});
  const ps=fmt.formatToParts(new Date()); const m={}; for(const p of ps) if(p.type!=='literal') m[p.type]=+p.value;
  return {Y:m.year, M:m.month, D:m.day, h:m.hour, min:m.minute, s:m.second};
}
function computeLeft(ms){
  if(ms<=0) return {d:0,h:0,m:0,s:0,done:true};
  let t=Math.floor(ms/1000);
  const d=Math.floor(t/86400); t%=86400;
  const h=Math.floor(t/3600);  t%=3600;
  const m=Math.floor(t/60);    t%=60;
  const s=t; return {d,h,m,s,done:false};
}

function render(){
  const now = Date.now();
  const left = computeLeft(TARGET - now);
  const z = nowInZoneParts(TZ);

  document.getElementById('nowline').textContent =
    `å½“å‰ï¼ˆ${TZ}ï¼‰ï¼š${z.Y}-${pad(z.M)}-${pad(z.D)} ${pad(z.h)}:${pad(z.min)}:${pad(z.s)}`;
  document.getElementById('targetline').textContent =
    `ç›¸è§æ—¶é—´ï¼ˆ${TZ}ï¼‰ï¼š2025-12-21 09:00:00`;

  const panel = document.getElementById('panel'); panel.innerHTML='';
  const add = (num,label)=>{
    const c=document.createElement('div'); c.className='card';
    c.innerHTML = '<div class="num">'+ num +'</div><div class="label">'+ label +'</div>';
    panel.appendChild(c);
  };
  add(left.d,'å¤©'); add(left.h,'å°æ—¶'); add(left.m,'åˆ†é’Ÿ'); add(left.s,'ç§’');

  document.getElementById('summary').textContent =
    left.done ? 'å°±æ˜¯ç°åœ¨ï¼åˆ°ä½ èº«è¾¹å•¦ ğŸ’'
              : `è¿˜æœ‰ ${left.d} å¤© ${left.h} å°æ—¶ ${left.m} åˆ†é’Ÿ ${left.s} ç§’`;
}
render(); setInterval(render,1000);
</script>
</body>
</html>
